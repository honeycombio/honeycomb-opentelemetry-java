version: 2.1

orbs:
  gradle: circleci/gradle@2.2.0

matrix_executors: &matrix_executors
  matrix:
    parameters:
      executor:
        - name: gradle/default
          tag: "8.0"
        - name: gradle/default
          tag: "11.0"
        - name: gradle/default
          tag: "13.0"

workflows:
  version: 2
  nightly:
    triggers:
      - schedule:
          cron: "0 0 * * *"
          filters:
            branches:
              only:
                - main
    jobs:
      - gradle/test:
          <<: *matrix_executors
  build:
    jobs:
      - gradle/test:
          <<: *matrix_executors
          filters:
            tags:
              only: /.*/
